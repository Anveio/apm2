{
  "schema": "cac.protocol_bundle.v1",
  "meta": {
    "title": "Agent-Native Software Factory: Protocols & Doctrine",
    "version": "1.0.0",
    "created_at": "2026-02-04T22:27:53.975717Z",
    "description": "Normative definitions, architectural doctrines, and implementation protocols for the durable, auditable work substrate."
  },
  "payload": {
    "lexicon": [
      {
        "term": "Work Substrate",
        "definition": "The authoritative coordination plane comprising: (a) work-object specs, (b) append-only durable event records (including Sub-Episode Checkpoints), and (c) deterministic projections. It MAY include Canonical State Snapshots."
      },
      {
        "term": "Work Object",
        "definition": "A typed entity with stable canonical identifier and explicit lifecycle (state machine). Foundational kinds: Plan, ChangeSet, GateRun, Finding, EvidenceBundle, Decision, Question, OracleRequest."
      },
      {
        "term": "Plan-of-Record",
        "definition": "Approved Plan specification snapshot bound by content digest. The binding surface for downstream refinement to prevent 'drift by commentary'."
      },
      {
        "term": "Spec Snapshot",
        "definition": "Deterministic representation of specification content (YAML sections, attachments, schema versions), canonicalized and hashed. Provides stable identity for 'what was reviewed'."
      },
      {
        "term": "ChangeSet",
        "definition": "Canonical unit of proposed work. Defined by input references (Plan-of-Record), patch representation (git commit range or portable patch set), and produced artifacts."
      },
      {
        "term": "Gate",
        "definition": "Formally defined verification protocol with rubric, evidence contract, allowed tools, and stop conditions."
      },
      {
        "term": "GateRun",
        "definition": "Execution instance of a Gate against a Plan or ChangeSet, producing a decision and bounded set of Findings."
      },
      {
        "term": "Finding",
        "definition": "Structured nonconformance report with severity, category, location, and deterministic FindingSignature."
      },
      {
        "term": "FindingSignature",
        "definition": "Deterministic identifier computed from normalized fields (category, rule ID, subsystem, normalized location) to cluster recurrence."
      },
      {
        "term": "Countermeasure",
        "definition": "Planned work to prevent recurrence of a FindingSignature by modifying guardrails. Validated by evidence of reduced recurrence."
      },
      {
        "term": "Merge Receipt",
        "definition": "Internal acceptance record binding approval decision to exact input digests (Plan, ChangeSet, GateRuns) and output repo state digest."
      }
    ],
    "doctrines": [
      {
        "id": "DOC-SPEC-STATE-SEP",
        "name": "Spec/State Separation",
        "rule": "Strict separation between specification content (schema-validated YAML) and workflow state (derived from event record). Workflow state MUST NOT be inferred from filesystem scans or branch names."
      },
      {
        "id": "DOC-EVENT-AUTHORITY",
        "name": "Event Authority",
        "rule": "Append-only event log is the authoritative record. Projections are computed by deterministic reducers."
      },
      {
        "id": "DOC-INTERNAL-FORGE",
        "name": "Internal Forge Model",
        "rule": "Forge semantics (proposal, review, acceptance) are native work semantics. ChangeSets are not synonymous with branches. Merges are governed state transitions yielding Merge Receipts."
      },
      {
        "id": "DOC-GATE-PROTOCOL",
        "name": "Gate Protocol",
        "rule": "Verification gates are protocols with evidence contracts. Decisions must be backed by EvidenceBundles stored in CAS. AAT is an independent gate."
      },
      {
        "id": "DOC-RECURRENCE-LOOP",
        "name": "Recurrence Loop",
        "rule": "Repeated issues indicate factory control failure. Normalized FindingSignatures drive recurrence metrics, triggering Countermeasure work to improve guardrails."
      },
      {
        "id": "DOC-HARDENING-CYCLE",
        "name": "Hardening Cycle",
        "rule": "Lifecycle includes post-implementation hardening cycles for refactoring, simplification, and integration coherence. Stopping condition is measurable reduction of complexity."
      }
    ],
    "protocols": [
      {
        "id": "PROTO-GATE-EXEC",
        "steps": [
          "Load rubric and evidence schema.",
          "Instantiate runner with allowed tools and budget.",
          "Execute checks/tests.",
          "Emit Findings with signatures.",
          "Publish EvidenceBundle (raw outputs, digests, provenance).",
          "Emit GateRun event with decision (Pass/Fail/Escalate)."
        ]
      },
      {
        "id": "PROTO-MERGE",
        "steps": [
          "Acquire lease (exclusive authority).",
          "Verify input digests (Plan-of-Record, ChangeSet, GateRuns, Decisions).",
          "Verify repository state digest.",
          "Apply patch/update refs.",
          "Emit Merge Receipt event binding inputs to output state.",
          "Release lease."
        ]
      },
      {
        "id": "PROTO-RECURRENCE",
        "steps": [
          "Normalize Finding fields.",
          "Compute FindingSignature.",
          "Reducer updates recurrence counts/rates.",
          "If threshold exceeded: Schedule Countermeasure.",
          "Implement Countermeasure (guardrail update).",
          "Verify Countermeasure (corpus replay evidence).",
          "Deploy Countermeasure with rollback plan."
        ]
      }
    ],
    "prescriptions": {
      "language": "Rust",
      "serialization": "prost (Protocol Buffers) for events, serde_yaml/schemars for specs",
      "hashing": "blake3",
      "signing": "ed25519-dalek",
      "storage": "rusqlite (SQLite with WAL) for local durability",
      "git_interaction": "gix (gitoxide) for deterministic inspection",
      "secrets": "secrecy, zeroize, chacha20poly1305 for sensitive artifacts",
      "observability": "tracing for structured instrumentation",
      "policy": "cedar-policy for authority rules"
    }
  }
}