rfc_trust_boundaries:
  schema_version: "2026-01-24"
  template_version: "2026-01-24"
  boundaries:
  - id: TB-3001
    name: "Holon Contract Surface (Markov Blanket)"
    description: |
      The primary trust boundary between a holon and its environment. All
      interactions cross this boundary through typed Input/Output channels.
      Internal state is not directly accessible from outside the holon.
    actors:
    - id: ACTOR-HOLON
      name: "Holon Instance"
      trust_level: TRUSTED_WITHIN_SCOPE
      description: "Executes within lease scope; untrusted for actions outside scope"
    - id: ACTOR-SUPERVISOR
      name: "Supervisor Holon"
      trust_level: TRUSTED
      description: "Issues leases, validates artifacts, handles escalations"
    - id: ACTOR-SUB-HOLON
      name: "Sub-Holon"
      trust_level: DELEGATED
      description: "Receives delegated authority via lease from parent holon"
    entrypoints:
    - id: EP-3001
      name: "Work intake"
      protocol: "Typed Input via Holon::intake()"
      authentication: "Lease validation"
      authorization: "Lease scope checked against input requirements"
    - id: EP-3002
      name: "Artifact emission"
      protocol: "Typed Artifact via Holon::emit_artifact()"
      authentication: "WorkId validation"
      authorization: "Artifact category checked against lease scope"
    - id: EP-3003
      name: "Escalation"
      protocol: "EscalationReason via Holon::escalate()"
      authentication: "WorkId validation"
      authorization: "Always allowed within active work"
    data_flows:
    - id: DF-3001
      name: "Work request flow"
      source: ACTOR-SUPERVISOR
      destination: ACTOR-HOLON
      data_classification: INTERNAL
      description: "Supervisor sends work request with lease to holon"
    - id: DF-3002
      name: "Artifact flow"
      source: ACTOR-HOLON
      destination: ACTOR-SUPERVISOR
      data_classification: INTERNAL
      description: "Holon emits artifact to ledger via supervisor"
    - id: DF-3003
      name: "Delegation flow"
      source: ACTOR-HOLON
      destination: ACTOR-SUB-HOLON
      data_classification: INTERNAL
      description: "Holon delegates work to sub-holon with derived lease"
    authn_authz:
      authn: "Leases are signed by issuing authority; holon identity bound to lease"
      authz: "Lease scope defines permitted operations; exceeded scope triggers escalation"
    risks:
    - id: RSK-TB-3001
      statement: "Holon attempts to exceed lease scope"
      mitigation: "Lease validation on every operation; exceeded scope rejected"
    - id: RSK-TB-3002
      statement: "Holon emits invalid artifacts"
      mitigation: "Artifact validation against category schema; invalid artifacts rejected"
    - id: RSK-TB-3003
      statement: "Sub-holon attempts to use parent's lease directly"
      mitigation: "Leases are non-transferable; sub-holons must receive derived leases"
    evidence_ids:
    - EVID-3001
    - EVID-3004

  - id: TB-3002
    name: "Episode Execution Boundary"
    description: |
      The boundary around a single episode of agent execution. Episodes have
      bounded context windows, explicit stop conditions, and isolated state.
      Episode results are committed atomically to the ledger.
    actors:
    - id: ACTOR-EPISODE-CTL
      name: "Episode Controller"
      trust_level: TRUSTED
      description: "Manages episode lifecycle, enforces budgets, evaluates stop conditions"
    - id: ACTOR-AGENT
      name: "Agent (LLM)"
      trust_level: UNTRUSTED
      description: "Probabilistic inference engine; may produce invalid outputs"
    entrypoints:
    - id: EP-3001
      name: "Episode execution"
      protocol: "EpisodeContext via Holon::execute_episode()"
      authentication: "Active WorkId and lease"
      authorization: "Budget checked before execution"
    data_flows:
    - id: DF-3001
      name: "Context provisioning"
      source: ACTOR-EPISODE-CTL
      destination: ACTOR-AGENT
      data_classification: INTERNAL
      description: "Controller provides curated context to agent"
    - id: DF-3002
      name: "Episode result"
      source: ACTOR-AGENT
      destination: ACTOR-EPISODE-CTL
      data_classification: INTERNAL
      description: "Agent returns proposals and artifacts"
    authn_authz:
      authn: "Episode bound to WorkId and lease"
      authz: "Budget enforcement per episode; tool allowlist from lease"
    risks:
    - id: RSK-TB-3001
      statement: "Agent produces malformed output"
      mitigation: "Episode result validation; malformed results rejected"
    - id: RSK-TB-3002
      statement: "Episode exceeds budget"
      mitigation: "Budget tracking enforced by controller; exceeded triggers stop"
    - id: RSK-TB-3003
      statement: "Agent attempts to access tools outside allowlist"
      mitigation: "Tool requests validated against lease; unauthorized denied"
    evidence_ids:
    - EVID-3002

  - id: TB-3003
    name: "Ledger Integrity Boundary"
    description: |
      The boundary protecting the event ledger from tampering. All state
      derives from ledger events. Events are content-addressed and signed.
    actors:
    - id: ACTOR-LEDGER
      name: "Ledger Module"
      trust_level: TRUSTED
      description: "Append-only event store; source of truth"
    - id: ACTOR-PROJECTOR
      name: "State Projector"
      trust_level: TRUSTED
      description: "Computes state from event history"
    - id: ACTOR-WRITER
      name: "Event Writer"
      trust_level: TRUSTED_WITHIN_SCOPE
      description: "Authorized to append events; scoped to holon identity"
    entrypoints:
    - id: EP-3001
      name: "Event append"
      protocol: "LedgerEvent via Ledger::append()"
      authentication: "Holon identity signature"
      authorization: "Event type authorized for holon role"
    - id: EP-3002
      name: "State projection"
      protocol: "Query via Ledger::project()"
      authentication: "None (read-only)"
      authorization: "Projection scope based on WorkId"
    data_flows:
    - id: DF-3001
      name: "Event write"
      source: ACTOR-WRITER
      destination: ACTOR-LEDGER
      data_classification: INTERNAL
      description: "Signed event appended to ledger"
    - id: DF-3002
      name: "State derivation"
      source: ACTOR-LEDGER
      destination: ACTOR-PROJECTOR
      data_classification: INTERNAL
      description: "Events read for state projection"
    authn_authz:
      authn: "Events signed with holon identity key"
      authz: "Event type whitelist per holon role"
    risks:
    - id: RSK-TB-3001
      statement: "Unauthorized event injection"
      mitigation: "Signature verification on append; invalid signatures rejected"
    - id: RSK-TB-3002
      statement: "Event replay attack"
      mitigation: "Sequence numbers and content hashing prevent replay"
    - id: RSK-TB-3003
      statement: "Ledger corruption"
      mitigation: "Hash chain verification; corruption detected on read"
    evidence_ids:
    - EVID-3002

  - id: TB-3004
    name: "Lease Authority Boundary"
    description: |
      The boundary between lease-granted authority and unauthorized actions.
      All resource consumption requires valid lease. Leases define scope,
      budget, and expiration.
    actors:
    - id: ACTOR-REGISTRAR
      name: "Lease Registrar"
      trust_level: TRUSTED
      description: "Issues, renews, and revokes leases; enforces uniqueness"
    - id: ACTOR-LEASEHOLDER
      name: "Lease Holder"
      trust_level: TRUSTED_WITHIN_LEASE
      description: "Holon holding active lease; authorized within lease scope"
    entrypoints:
    - id: EP-3001
      name: "Lease request"
      protocol: "LeaseRequest to registrar"
      authentication: "Holon identity"
      authorization: "Holon must be eligible for work"
    - id: EP-3002
      name: "Lease renewal"
      protocol: "RenewalRequest with current lease"
      authentication: "Current lease validation"
      authorization: "Renewal within budget limits"
    - id: EP-3003
      name: "Lease release"
      protocol: "ReleaseRequest with current lease"
      authentication: "Current lease validation"
      authorization: "Always allowed by leaseholder"
    data_flows:
    - id: DF-3001
      name: "Lease grant"
      source: ACTOR-REGISTRAR
      destination: ACTOR-LEASEHOLDER
      data_classification: INTERNAL
      description: "Signed lease issued to holon"
    - id: DF-3002
      name: "Budget consumption"
      source: ACTOR-LEASEHOLDER
      destination: ACTOR-REGISTRAR
      data_classification: INTERNAL
      description: "Budget updates recorded as events"
    authn_authz:
      authn: "Leases signed by registrar; holon must present valid lease"
      authz: "Operations checked against lease scope and remaining budget"
    risks:
    - id: RSK-TB-3001
      statement: "Lease forgery"
      mitigation: "Registrar signature verification; forged leases rejected"
    - id: RSK-TB-3002
      statement: "Expired lease use"
      mitigation: "Expiration checked on every operation; expired leases invalid"
    - id: RSK-TB-3003
      statement: "Budget exhaustion without termination"
      mitigation: "Budget enforcement in episode controller; exhaustion triggers stop"
    evidence_ids:
    - EVID-3004
