rfc_requirement:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  id: REQ-1004
  type: SECURITY
  title: "Cryptographic key management and rotation"
  statement: |
    The kernel MUST manage cryptographic keys (actor signing keys, ledger
    integrity keys) with secure generation, storage, and rotation procedures
    that do not require system restart.
  acceptance_criteria:
  - Keys are generated using OS-provided CSPRNG (getrandom).
  - Private keys are stored with restrictive file permissions (0600).
  - Key rotation emits a KEY.ROTATED event and updates projections.
  - Old signatures remain verifiable after rotation (key history preserved).
  evidence:
    evidence_ids:
    - EVID-1004
    inherited_from_prd: false
    notes:
    - "Validated by key rotation integration tests"
