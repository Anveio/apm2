rfc_problem_and_imports:
  schema_version: "2026-01-23"
  template_version: "2026-01-23"
  imported_from_prd:
    problem_ref: "02_problem.yaml#prd_problem"
    goals_scope_ref: "03_goals_scope.yaml#prd_goals_scope"
    constraints_invariants_ref: "06_constraints_invariants.yaml#prd_constraints_invariants"
    quality_framework_ref: "10_quality_framework.yaml#prd_quality_framework"
  protocol_profile_imports:
    required_rfc_section_refs: []
  rfc_specific_problem_detail:
    additional_context: |
      This RFC addresses the implementation of the APM2 kernel - the foundational
      runtime that enables autonomous software engineering. The kernel provides:

      1. **Supervisor**: Crash-only session management with entropy-based health
         tracking, deterministic restart/quarantine, and exit classification.

      2. **Ledger**: Append-only, hash-chained, signed event store using SQLite
         with WAL mode. Stores kernel events and content-addressed artifact refs.

      3. **Reducers/Projections**: Deterministic computation of active leases,
         session health, policy posture, evidence index, and factory KPIs.

      4. **Policy Engine**: Default-deny syscall mediation with budget enforcement,
         audited rule IDs, and deterministic allow/deny decisions.

      5. **Harness/Adapters**: Vendor-agnostic wrappers that normalize agent
         observability and enforce syscall mediation boundaries.

      6. **Work Protocol (HWP)**: Durable work contracts with lease-based claiming,
         typed questions/answers, and evidence publication for gate closure.

      Federation (multi-node QUIC links) is stubbed but deferred to RFC-0002.
    out_of_scope_confirmations:
    - "Permissionless peer discovery and Sybil-resistant open networks (NG-0001)"
    - "Marketplace/bidding economy (NG-0002)"
    - "Custom distributed consensus (NG-0003) - single registrar per subtree"
    - "Vendor-specific agent API coupling (NG-0004)"
    - "Large blob storage in ledger (NG-0005)"
    - "QUIC federation implementation - stubbed interface only (deferred to RFC-0002)"
  requirement_binding:
    bound_requirement_ids:
    # Core factory loop
    - REQ-0001  # Autonomous factory run command
    - REQ-0002  # Template-bound PRD/RFC generation
    - REQ-0003  # Autonomous ticket decomposition
    # Policy and security
    - REQ-0004  # Default-deny tool mediation
    - REQ-0005  # Policy allowlists and budget enforcement
    - REQ-0006  # Signed ledger records
    # Ledger and reducers
    - REQ-0007  # Deterministic reducers and projections
    - REQ-0008  # Hash-chained append-only ledger
    - REQ-0009  # Content-addressed artifact references
    # Adapters and sessions
    - REQ-0010  # Vendor-agnostic harness adapters
    - REQ-0011  # Bounded fanout and message rates
    - REQ-0012  # Deterministic event encoding (protobuf)
    - REQ-0013  # Actor identity stability across restarts
    # Work protocol
    - REQ-0014  # Work contracts with spec snapshots
    - REQ-0015  # Evidence bundles for gate closure
    - REQ-0016  # Gate receipt generation
    # Observability
    - REQ-0017  # Metrics, traces, and audit events
    - REQ-0018  # Crash-only session recovery
    - REQ-0019  # Budget tracking and cost attribution
    # Reliability
    - REQ-0020  # Partition tolerance and convergence
    - REQ-0021  # Holonic scaling with bounded fanout
    - REQ-0022  # Lease-based work ownership
    - REQ-0023  # Data classification and redaction
    - REQ-0024  # Schema versioning and compatibility
    # Testing and quality
    - REQ-0025  # Property-based testing for reducers
    - REQ-0026  # Integration test harness
    - REQ-0027  # Error handling and rationale codes
    - REQ-0028  # Machine-readable CLI output
    # Operability
    - REQ-0029  # Backward compatibility windows
    - REQ-0030  # Runbook automation hooks
    # Governance
    - REQ-0031  # Adjudication timeout and fallback
    - REQ-0032  # N-of-M quorum signatures
    - REQ-0033  # Rework loop budgets
    - REQ-0034  # Holonic boundary integrity
    - REQ-0035  # Entropy budget enforcement
    - REQ-0036  # Lease registrar authority
    - REQ-0037  # Canonical root selection for reconciliation
    - REQ-0038  # Gate receipt auto-generation
    added_rfc_only_requirements:
      mode: FILE_PER_REQUIREMENT
      local_root: "requirements/"
      local_requirements:
      - requirement_id: REQ-1001
        requirement_ref: "requirements/REQ-1001.yaml#rfc_requirement"
      - requirement_id: REQ-1002
        requirement_ref: "requirements/REQ-1002.yaml#rfc_requirement"
      - requirement_id: REQ-1003
        requirement_ref: "requirements/REQ-1003.yaml#rfc_requirement"
      - requirement_id: REQ-1004
        requirement_ref: "requirements/REQ-1004.yaml#rfc_requirement"
      - requirement_id: REQ-1005
        requirement_ref: "requirements/REQ-1005.yaml#rfc_requirement"
      - requirement_id: REQ-1006
        requirement_ref: "requirements/REQ-1006.yaml#rfc_requirement"
      rationale: |
        RFC-only requirements address implementation-specific concerns not
        covered by PRD requirements: module boundaries, Rust-specific patterns,
        test infrastructure, and development tooling.
      evidence_policy: "RFC-only requirements define evidence in 07_test_and_evidence.yaml or evidence_artifacts/"
